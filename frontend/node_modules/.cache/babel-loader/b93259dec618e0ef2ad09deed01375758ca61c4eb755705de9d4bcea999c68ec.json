{"ast":null,"code":"var _jsxFileName = \"/Users/sanji/AA/Seed Account/frontend/src/components/RingSignatureVisualizer.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport './RingSignatureVisualizer.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction RingSignatureVisualizer({\n  signatureDetails,\n  seedAddress\n}) {\n  _s();\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    if (!signatureDetails || !canvasRef.current) return;\n\n    // 确保 signatureDetails 包含必要的数据\n    if (!signatureDetails.ring || !signatureDetails.keyImage) {\n      console.error('环签名详情缺少必要数据');\n      return;\n    }\n\n    // 解析签名数据\n    let signature;\n    try {\n      signature = typeof signatureDetails.signature === 'string' ? JSON.parse(signatureDetails.signature) : signatureDetails.signature;\n    } catch (error) {\n      console.error('解析签名数据失败:', error);\n      return;\n    }\n\n    // 确保签名数据包含必要的字段\n    if (!signature || !signature.c || !signature.r) {\n      console.error('签名数据缺少必要字段');\n      return;\n    }\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const radius = Math.min(width, height) / 2 - 50;\n\n    // 清除画布\n    ctx.clearRect(0, 0, width, height);\n\n    // 绘制环\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n    ctx.strokeStyle = '#ccc';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n\n    // 绘制环成员\n    const ring = signatureDetails.ring;\n    const n = ring.length;\n    ring.forEach((address, i) => {\n      const angle = i / n * 2 * Math.PI;\n      const x = centerX + radius * Math.cos(angle);\n      const y = centerY + radius * Math.sin(angle);\n\n      // 绘制节点\n      ctx.beginPath();\n      ctx.arc(x, y, 10, 0, 2 * Math.PI);\n\n      // 如果是签名者，使用不同颜色\n      if (address.toLowerCase() === seedAddress.toLowerCase()) {\n        ctx.fillStyle = '#ff6b6b';\n      } else {\n        ctx.fillStyle = '#4ecdc4';\n      }\n      ctx.fill();\n      ctx.strokeStyle = '#333';\n      ctx.lineWidth = 1;\n      ctx.stroke();\n\n      // 绘制地址标签\n      ctx.fillStyle = '#333';\n      ctx.font = '10px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText(address.substring(0, 6) + '...' + address.substring(38), x, y + 25);\n    });\n\n    // 绘制关键映像\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);\n    ctx.fillStyle = '#f9dc5c';\n    ctx.fill();\n    ctx.strokeStyle = '#333';\n    ctx.lineWidth = 1;\n    ctx.stroke();\n\n    // 绘制关键映像标签\n    ctx.fillStyle = '#333';\n    ctx.font = '12px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText('Key Image', centerX, centerY + 5);\n\n    // 绘制连接线\n    // 确保 c 和 r 是数组\n    if (Array.isArray(signature.c) && Array.isArray(signature.r)) {\n      ring.forEach((_, i) => {\n        const angle = i / n * 2 * Math.PI;\n        const x = centerX + radius * Math.cos(angle);\n        const y = centerY + radius * Math.sin(angle);\n\n        // 绘制到中心的连接线\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(centerX, centerY);\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';\n        ctx.lineWidth = 1;\n        ctx.stroke();\n\n        // 在连接线上显示 c 和 r 值的前几个字符\n        const midX = (x + centerX) / 2;\n        const midY = (y + centerY) / 2;\n        if (signature.c[i]) {\n          ctx.fillStyle = '#333';\n          ctx.font = '9px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(`c: ${signature.c[i].substring(0, 4)}...`, midX, midY - 5);\n        }\n        if (signature.r[i]) {\n          ctx.fillStyle = '#333';\n          ctx.font = '9px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(`r: ${signature.r[i].substring(0, 4)}...`, midX, midY + 10);\n        }\n      });\n    }\n  }, [signatureDetails, seedAddress]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ring-signature-visualizer\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\u73AF\\u7B7E\\u540D\\u53EF\\u89C6\\u5316\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: 600,\n      height: 400\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this);\n}\n_s(RingSignatureVisualizer, \"UJgi7ynoup7eqypjnwyX/s32POg=\");\n_c = RingSignatureVisualizer;\nexport default RingSignatureVisualizer;\nvar _c;\n$RefreshReg$(_c, \"RingSignatureVisualizer\");","map":{"version":3,"names":["React","useEffect","useRef","jsxDEV","_jsxDEV","RingSignatureVisualizer","signatureDetails","seedAddress","_s","canvasRef","current","ring","keyImage","console","error","signature","JSON","parse","c","r","canvas","ctx","getContext","width","height","centerX","centerY","radius","Math","min","clearRect","beginPath","arc","PI","strokeStyle","lineWidth","stroke","n","length","forEach","address","i","angle","x","cos","y","sin","toLowerCase","fillStyle","fill","font","textAlign","fillText","substring","Array","isArray","_","moveTo","lineTo","midX","midY","className","children","fileName","_jsxFileName","lineNumber","columnNumber","ref","_c","$RefreshReg$"],"sources":["/Users/sanji/AA/Seed Account/frontend/src/components/RingSignatureVisualizer.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport './RingSignatureVisualizer.css';\n\nfunction RingSignatureVisualizer({ signatureDetails, seedAddress }) {\n  const canvasRef = useRef(null);\n  \n  useEffect(() => {\n    if (!signatureDetails || !canvasRef.current) return;\n    \n    // 确保 signatureDetails 包含必要的数据\n    if (!signatureDetails.ring || !signatureDetails.keyImage) {\n      console.error('环签名详情缺少必要数据');\n      return;\n    }\n    \n    // 解析签名数据\n    let signature;\n    try {\n      signature = typeof signatureDetails.signature === 'string' \n        ? JSON.parse(signatureDetails.signature) \n        : signatureDetails.signature;\n    } catch (error) {\n      console.error('解析签名数据失败:', error);\n      return;\n    }\n    \n    // 确保签名数据包含必要的字段\n    if (!signature || !signature.c || !signature.r) {\n      console.error('签名数据缺少必要字段');\n      return;\n    }\n    \n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext('2d');\n    const width = canvas.width;\n    const height = canvas.height;\n    const centerX = width / 2;\n    const centerY = height / 2;\n    const radius = Math.min(width, height) / 2 - 50;\n    \n    // 清除画布\n    ctx.clearRect(0, 0, width, height);\n    \n    // 绘制环\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n    ctx.strokeStyle = '#ccc';\n    ctx.lineWidth = 2;\n    ctx.stroke();\n    \n    // 绘制环成员\n    const ring = signatureDetails.ring;\n    const n = ring.length;\n    \n    ring.forEach((address, i) => {\n      const angle = (i / n) * 2 * Math.PI;\n      const x = centerX + radius * Math.cos(angle);\n      const y = centerY + radius * Math.sin(angle);\n      \n      // 绘制节点\n      ctx.beginPath();\n      ctx.arc(x, y, 10, 0, 2 * Math.PI);\n      \n      // 如果是签名者，使用不同颜色\n      if (address.toLowerCase() === seedAddress.toLowerCase()) {\n        ctx.fillStyle = '#ff6b6b';\n      } else {\n        ctx.fillStyle = '#4ecdc4';\n      }\n      \n      ctx.fill();\n      ctx.strokeStyle = '#333';\n      ctx.lineWidth = 1;\n      ctx.stroke();\n      \n      // 绘制地址标签\n      ctx.fillStyle = '#333';\n      ctx.font = '10px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText(address.substring(0, 6) + '...' + address.substring(38), x, y + 25);\n    });\n    \n    // 绘制关键映像\n    ctx.beginPath();\n    ctx.arc(centerX, centerY, 20, 0, 2 * Math.PI);\n    ctx.fillStyle = '#f9dc5c';\n    ctx.fill();\n    ctx.strokeStyle = '#333';\n    ctx.lineWidth = 1;\n    ctx.stroke();\n    \n    // 绘制关键映像标签\n    ctx.fillStyle = '#333';\n    ctx.font = '12px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText('Key Image', centerX, centerY + 5);\n    \n    // 绘制连接线\n    // 确保 c 和 r 是数组\n    if (Array.isArray(signature.c) && Array.isArray(signature.r)) {\n      ring.forEach((_, i) => {\n        const angle = (i / n) * 2 * Math.PI;\n        const x = centerX + radius * Math.cos(angle);\n        const y = centerY + radius * Math.sin(angle);\n        \n        // 绘制到中心的连接线\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(centerX, centerY);\n        ctx.strokeStyle = 'rgba(0, 0, 0, 0.2)';\n        ctx.lineWidth = 1;\n        ctx.stroke();\n        \n        // 在连接线上显示 c 和 r 值的前几个字符\n        const midX = (x + centerX) / 2;\n        const midY = (y + centerY) / 2;\n        \n        if (signature.c[i]) {\n          ctx.fillStyle = '#333';\n          ctx.font = '9px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(`c: ${signature.c[i].substring(0, 4)}...`, midX, midY - 5);\n        }\n        \n        if (signature.r[i]) {\n          ctx.fillStyle = '#333';\n          ctx.font = '9px Arial';\n          ctx.textAlign = 'center';\n          ctx.fillText(`r: ${signature.r[i].substring(0, 4)}...`, midX, midY + 10);\n        }\n      });\n    }\n  }, [signatureDetails, seedAddress]);\n  \n  return (\n    <div className=\"ring-signature-visualizer\">\n      <h3>环签名可视化</h3>\n      <canvas ref={canvasRef} width={600} height={400} />\n    </div>\n  );\n}\n\nexport default RingSignatureVisualizer; "],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAChD,OAAO,+BAA+B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEvC,SAASC,uBAAuBA,CAAC;EAAEC,gBAAgB;EAAEC;AAAY,CAAC,EAAE;EAAAC,EAAA;EAClE,MAAMC,SAAS,GAAGP,MAAM,CAAC,IAAI,CAAC;EAE9BD,SAAS,CAAC,MAAM;IACd,IAAI,CAACK,gBAAgB,IAAI,CAACG,SAAS,CAACC,OAAO,EAAE;;IAE7C;IACA,IAAI,CAACJ,gBAAgB,CAACK,IAAI,IAAI,CAACL,gBAAgB,CAACM,QAAQ,EAAE;MACxDC,OAAO,CAACC,KAAK,CAAC,aAAa,CAAC;MAC5B;IACF;;IAEA;IACA,IAAIC,SAAS;IACb,IAAI;MACFA,SAAS,GAAG,OAAOT,gBAAgB,CAACS,SAAS,KAAK,QAAQ,GACtDC,IAAI,CAACC,KAAK,CAACX,gBAAgB,CAACS,SAAS,CAAC,GACtCT,gBAAgB,CAACS,SAAS;IAChC,CAAC,CAAC,OAAOD,KAAK,EAAE;MACdD,OAAO,CAACC,KAAK,CAAC,WAAW,EAAEA,KAAK,CAAC;MACjC;IACF;;IAEA;IACA,IAAI,CAACC,SAAS,IAAI,CAACA,SAAS,CAACG,CAAC,IAAI,CAACH,SAAS,CAACI,CAAC,EAAE;MAC9CN,OAAO,CAACC,KAAK,CAAC,YAAY,CAAC;MAC3B;IACF;IAEA,MAAMM,MAAM,GAAGX,SAAS,CAACC,OAAO;IAChC,MAAMW,GAAG,GAAGD,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC;IACnC,MAAMC,KAAK,GAAGH,MAAM,CAACG,KAAK;IAC1B,MAAMC,MAAM,GAAGJ,MAAM,CAACI,MAAM;IAC5B,MAAMC,OAAO,GAAGF,KAAK,GAAG,CAAC;IACzB,MAAMG,OAAO,GAAGF,MAAM,GAAG,CAAC;IAC1B,MAAMG,MAAM,GAAGC,IAAI,CAACC,GAAG,CAACN,KAAK,EAAEC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;;IAE/C;IACAH,GAAG,CAACS,SAAS,CAAC,CAAC,EAAE,CAAC,EAAEP,KAAK,EAAEC,MAAM,CAAC;;IAElC;IACAH,GAAG,CAACU,SAAS,CAAC,CAAC;IACfV,GAAG,CAACW,GAAG,CAACP,OAAO,EAAEC,OAAO,EAAEC,MAAM,EAAE,CAAC,EAAE,CAAC,GAAGC,IAAI,CAACK,EAAE,CAAC;IACjDZ,GAAG,CAACa,WAAW,GAAG,MAAM;IACxBb,GAAG,CAACc,SAAS,GAAG,CAAC;IACjBd,GAAG,CAACe,MAAM,CAAC,CAAC;;IAEZ;IACA,MAAMzB,IAAI,GAAGL,gBAAgB,CAACK,IAAI;IAClC,MAAM0B,CAAC,GAAG1B,IAAI,CAAC2B,MAAM;IAErB3B,IAAI,CAAC4B,OAAO,CAAC,CAACC,OAAO,EAAEC,CAAC,KAAK;MAC3B,MAAMC,KAAK,GAAID,CAAC,GAAGJ,CAAC,GAAI,CAAC,GAAGT,IAAI,CAACK,EAAE;MACnC,MAAMU,CAAC,GAAGlB,OAAO,GAAGE,MAAM,GAAGC,IAAI,CAACgB,GAAG,CAACF,KAAK,CAAC;MAC5C,MAAMG,CAAC,GAAGnB,OAAO,GAAGC,MAAM,GAAGC,IAAI,CAACkB,GAAG,CAACJ,KAAK,CAAC;;MAE5C;MACArB,GAAG,CAACU,SAAS,CAAC,CAAC;MACfV,GAAG,CAACW,GAAG,CAACW,CAAC,EAAEE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,GAAGjB,IAAI,CAACK,EAAE,CAAC;;MAEjC;MACA,IAAIO,OAAO,CAACO,WAAW,CAAC,CAAC,KAAKxC,WAAW,CAACwC,WAAW,CAAC,CAAC,EAAE;QACvD1B,GAAG,CAAC2B,SAAS,GAAG,SAAS;MAC3B,CAAC,MAAM;QACL3B,GAAG,CAAC2B,SAAS,GAAG,SAAS;MAC3B;MAEA3B,GAAG,CAAC4B,IAAI,CAAC,CAAC;MACV5B,GAAG,CAACa,WAAW,GAAG,MAAM;MACxBb,GAAG,CAACc,SAAS,GAAG,CAAC;MACjBd,GAAG,CAACe,MAAM,CAAC,CAAC;;MAEZ;MACAf,GAAG,CAAC2B,SAAS,GAAG,MAAM;MACtB3B,GAAG,CAAC6B,IAAI,GAAG,YAAY;MACvB7B,GAAG,CAAC8B,SAAS,GAAG,QAAQ;MACxB9B,GAAG,CAAC+B,QAAQ,CAACZ,OAAO,CAACa,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,KAAK,GAAGb,OAAO,CAACa,SAAS,CAAC,EAAE,CAAC,EAAEV,CAAC,EAAEE,CAAC,GAAG,EAAE,CAAC;IAClF,CAAC,CAAC;;IAEF;IACAxB,GAAG,CAACU,SAAS,CAAC,CAAC;IACfV,GAAG,CAACW,GAAG,CAACP,OAAO,EAAEC,OAAO,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,GAAGE,IAAI,CAACK,EAAE,CAAC;IAC7CZ,GAAG,CAAC2B,SAAS,GAAG,SAAS;IACzB3B,GAAG,CAAC4B,IAAI,CAAC,CAAC;IACV5B,GAAG,CAACa,WAAW,GAAG,MAAM;IACxBb,GAAG,CAACc,SAAS,GAAG,CAAC;IACjBd,GAAG,CAACe,MAAM,CAAC,CAAC;;IAEZ;IACAf,GAAG,CAAC2B,SAAS,GAAG,MAAM;IACtB3B,GAAG,CAAC6B,IAAI,GAAG,YAAY;IACvB7B,GAAG,CAAC8B,SAAS,GAAG,QAAQ;IACxB9B,GAAG,CAAC+B,QAAQ,CAAC,WAAW,EAAE3B,OAAO,EAAEC,OAAO,GAAG,CAAC,CAAC;;IAE/C;IACA;IACA,IAAI4B,KAAK,CAACC,OAAO,CAACxC,SAAS,CAACG,CAAC,CAAC,IAAIoC,KAAK,CAACC,OAAO,CAACxC,SAAS,CAACI,CAAC,CAAC,EAAE;MAC5DR,IAAI,CAAC4B,OAAO,CAAC,CAACiB,CAAC,EAAEf,CAAC,KAAK;QACrB,MAAMC,KAAK,GAAID,CAAC,GAAGJ,CAAC,GAAI,CAAC,GAAGT,IAAI,CAACK,EAAE;QACnC,MAAMU,CAAC,GAAGlB,OAAO,GAAGE,MAAM,GAAGC,IAAI,CAACgB,GAAG,CAACF,KAAK,CAAC;QAC5C,MAAMG,CAAC,GAAGnB,OAAO,GAAGC,MAAM,GAAGC,IAAI,CAACkB,GAAG,CAACJ,KAAK,CAAC;;QAE5C;QACArB,GAAG,CAACU,SAAS,CAAC,CAAC;QACfV,GAAG,CAACoC,MAAM,CAACd,CAAC,EAAEE,CAAC,CAAC;QAChBxB,GAAG,CAACqC,MAAM,CAACjC,OAAO,EAAEC,OAAO,CAAC;QAC5BL,GAAG,CAACa,WAAW,GAAG,oBAAoB;QACtCb,GAAG,CAACc,SAAS,GAAG,CAAC;QACjBd,GAAG,CAACe,MAAM,CAAC,CAAC;;QAEZ;QACA,MAAMuB,IAAI,GAAG,CAAChB,CAAC,GAAGlB,OAAO,IAAI,CAAC;QAC9B,MAAMmC,IAAI,GAAG,CAACf,CAAC,GAAGnB,OAAO,IAAI,CAAC;QAE9B,IAAIX,SAAS,CAACG,CAAC,CAACuB,CAAC,CAAC,EAAE;UAClBpB,GAAG,CAAC2B,SAAS,GAAG,MAAM;UACtB3B,GAAG,CAAC6B,IAAI,GAAG,WAAW;UACtB7B,GAAG,CAAC8B,SAAS,GAAG,QAAQ;UACxB9B,GAAG,CAAC+B,QAAQ,CAAC,MAAMrC,SAAS,CAACG,CAAC,CAACuB,CAAC,CAAC,CAACY,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAEM,IAAI,EAAEC,IAAI,GAAG,CAAC,CAAC;QACzE;QAEA,IAAI7C,SAAS,CAACI,CAAC,CAACsB,CAAC,CAAC,EAAE;UAClBpB,GAAG,CAAC2B,SAAS,GAAG,MAAM;UACtB3B,GAAG,CAAC6B,IAAI,GAAG,WAAW;UACtB7B,GAAG,CAAC8B,SAAS,GAAG,QAAQ;UACxB9B,GAAG,CAAC+B,QAAQ,CAAC,MAAMrC,SAAS,CAACI,CAAC,CAACsB,CAAC,CAAC,CAACY,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,EAAEM,IAAI,EAAEC,IAAI,GAAG,EAAE,CAAC;QAC1E;MACF,CAAC,CAAC;IACJ;EACF,CAAC,EAAE,CAACtD,gBAAgB,EAAEC,WAAW,CAAC,CAAC;EAEnC,oBACEH,OAAA;IAAKyD,SAAS,EAAC,2BAA2B;IAAAC,QAAA,gBACxC1D,OAAA;MAAA0D,QAAA,EAAI;IAAM;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eACf9D,OAAA;MAAQ+D,GAAG,EAAE1D,SAAU;MAACc,KAAK,EAAE,GAAI;MAACC,MAAM,EAAE;IAAI;MAAAuC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAChD,CAAC;AAEV;AAAC1D,EAAA,CAzIQH,uBAAuB;AAAA+D,EAAA,GAAvB/D,uBAAuB;AA2IhC,eAAeA,uBAAuB;AAAC,IAAA+D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
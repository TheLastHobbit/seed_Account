{"ast":null,"code":"var _jsxFileName = \"/Users/sanji/AA/Seed Account/frontend/src/components/CertificationManager.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\nimport axios from 'axios';\nimport './CertificationManager.css';\nimport RingSignatureVisualizer from './RingSignatureVisualizer';\nimport config from '../config';\n\n// SeedCertifier 合约 ABI\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst contractABI = [\"function certifySeed(address seedAddr, address soulAddr, address[] calldata ring, bytes32 keyImage, bytes32[] calldata c, bytes32[] calldata r) external\", \"function certifySeedOptimized(address seedAddr, address soulAddr, address[] calldata ring, bytes32 keyImage, bytes32[] calldata z, bytes32 finalHash, bytes32 c0) external\", \"function isCertified(address seedAddr) external view returns (bool)\", \"function getSoulAccount(address seedAddr) external view returns (address)\", \"event SeedCertified(address indexed seedAddr, address indexed soulAddr, bytes32 keyImage)\"];\n\n// Sepolia 网络上部署的合约地址\nconst contractAddress = \"0x226C796394190AdAE21Bf619EE4296cD1C38b277\";\nfunction CertificationManager({\n  seedAddress,\n  soulAddress,\n  isCertified,\n  onCertificationUpdated\n}) {\n  _s();\n  const [status, setStatus] = useState('');\n  const [provider, setProvider] = useState(null);\n  const [signatureDetails, setSignatureDetails] = useState(null);\n  const [showDetails, setShowDetails] = useState(false);\n  const [processingStep, setProcessingStep] = useState('');\n  const [useOptimized, setUseOptimized] = useState(true);\n  const [balance, setBalance] = useState('0');\n  const [localIsCertified, setLocalIsCertified] = useState(isCertified);\n  const [verifying, setVerifying] = useState(false);\n  const [localSoulAddress, setLocalSoulAddress] = useState(soulAddress || '');\n\n  // 初始化\n  useEffect(() => {\n    const initProvider = async () => {\n      // 使用公共 RPC 提供商\n      const provider = new ethers.providers.JsonRpcProvider('https://sepolia.infura.io/v3/dbe77fbac5b8494e8f03b1099638abfd');\n      setProvider(provider);\n    };\n    initProvider();\n\n    // 从本地存储加载认证数据\n    const loadStoredCertification = () => {\n      try {\n        const storedCertification = localStorage.getItem('certificationDetails');\n        if (storedCertification) {\n          const certData = JSON.parse(storedCertification);\n          setSignatureDetails(certData);\n        }\n      } catch (error) {\n        console.error('加载存储的认证数据失败:', error);\n      }\n    };\n    loadStoredCertification();\n  }, []);\n\n  // 当 isCertified prop 变化时更新本地状态\n  useEffect(() => {\n    setLocalIsCertified(isCertified);\n  }, [isCertified]);\n\n  // 当根账户或提供商变化时，检查余额和认证状态\n  useEffect(() => {\n    if (seedAddress && provider) {\n      checkBalance();\n      checkCertificationStatus();\n    }\n  }, [seedAddress, provider]);\n\n  // 检查余额\n  const checkBalance = async () => {\n    if (!seedAddress || !provider) return;\n    try {\n      const balanceWei = await provider.getBalance(seedAddress);\n      // 将 Wei 转换为 ETH，并保留 5 位小数\n      const balanceEth = parseFloat(ethers.utils.formatEther(balanceWei)).toFixed(5);\n      setBalance(balanceEth);\n    } catch (error) {\n      console.error('获取余额失败:', error);\n      setStatus('获取余额失败: ' + error.message);\n    }\n  };\n\n  // 检查认证状态\n  const checkCertificationStatus = async () => {\n    if (!seedAddress || !provider) return;\n    try {\n      const contract = new ethers.Contract(contractAddress, contractABI, provider);\n      const certified = await contract.isCertified(seedAddress);\n      setLocalIsCertified(certified);\n      if (certified) {\n        const linkedSoul = await contract.getSoulAccount(seedAddress);\n        console.log('根账户已认证，关联的影子账户:', linkedSoul);\n\n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(true, signatureDetails);\n        }\n      } else {\n        console.log('根账户未认证');\n\n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(false, null);\n        }\n      }\n    } catch (error) {\n      console.error('检查认证状态失败:', error);\n      setStatus('检查认证状态失败: ' + error.message);\n    }\n  };\n\n  // 认证根账户（实际调用后端API）\n  const certifySeedAccount = async () => {\n    if (!seedAddress) {\n      setStatus('请先创建根账户');\n      console.log('认证失败: 未提供根账户地址');\n      return;\n    }\n    console.log('开始认证流程，根账户地址:', seedAddress);\n    try {\n      setStatus('正在准备认证...');\n      setProcessingStep('准备环签名');\n\n      // 获取私钥（在实际应用中，这应该从安全存储中获取）\n      const seedPrivateKey = localStorage.getItem('seedPrivateKey');\n      console.log('从本地存储获取私钥:', seedPrivateKey ? '成功' : '失败');\n\n      // 如果没有找到私钥，尝试从会话存储中获取\n      let privateKey = seedPrivateKey;\n      if (!privateKey) {\n        privateKey = sessionStorage.getItem('seedPrivateKey');\n        console.log('从会话存储获取私钥:', privateKey ? '成功' : '失败');\n      }\n\n      // 如果仍然没有找到私钥，尝试使用硬编码的测试私钥（仅用于开发）\n      if (!privateKey) {\n        // 这只是一个示例私钥，实际应用中不应该硬编码\n        privateKey = '0x' + '1'.repeat(64); // 示例私钥，实际使用时应替换\n        console.log('使用测试私钥:', privateKey.substring(0, 10) + '...');\n\n        // 将测试私钥保存到本地存储，以便后续使用\n        localStorage.setItem('seedPrivateKey', privateKey);\n        console.log('已将测试私钥保存到本地存储');\n      }\n\n      // 生成随机nonce防止重放攻击\n      const nonce = Math.floor(Math.random() * 1000000).toString();\n      console.log('生成nonce:', nonce);\n\n      // 准备请求数据\n      const requestData = {\n        seedAddress,\n        seedPrivateKey: privateKey,\n        soulAddress: localSoulAddress || '0x' + Array(40).fill(0).map(() => Math.floor(Math.random() * 16).toString(16)).join(''),\n        nonce\n      };\n      console.log('准备发送请求数据:', {\n        seedAddress: requestData.seedAddress,\n        seedPrivateKeyLength: requestData.seedPrivateKey ? requestData.seedPrivateKey.length : 0,\n        soulAddress: requestData.soulAddress,\n        nonce: requestData.nonce\n      });\n\n      // 在发送请求前检查API URL\n      console.log('API URL:', config.getApiUrl('generateSignature'));\n\n      // 检查本地存储中的所有项\n      console.log('本地存储内容:', {\n        seedAddress: localStorage.getItem('seedAddress'),\n        seedPrivateKeyExists: !!localStorage.getItem('seedPrivateKey'),\n        seedPrivateKeyLength: localStorage.getItem('seedPrivateKey') ? localStorage.getItem('seedPrivateKey').length : 0\n      });\n\n      // 调用后端API生成环签名\n      console.log('发送认证请求到后端...');\n      const response = await axios.post(config.getApiUrl('generateSignature'), requestData);\n      console.log('收到认证响应:', {\n        valid: response.data.valid,\n        hasAuthToken: !!response.data.authToken,\n        hasKeyImage: !!response.data.keyImage,\n        ringLength: response.data.ring ? response.data.ring.length : 0\n      });\n      if (response.data.valid) {\n        // 保存认证信息到本地存储\n        localStorage.setItem('authToken', response.data.authToken);\n        localStorage.setItem('seedAddress', seedAddress);\n        localStorage.setItem('keyImage', response.data.keyImage);\n        localStorage.setItem('ring', JSON.stringify(response.data.ring));\n        console.log('已保存认证信息到本地存储:', {\n          authToken: response.data.authToken ? response.data.authToken.substring(0, 8) + '...' : null,\n          seedAddress,\n          keyImage: response.data.keyImage ? response.data.keyImage.substring(0, 10) + '...' : null\n        });\n\n        // 保存签名详情\n        const signatureData = {\n          ring: response.data.ring,\n          keyImage: response.data.keyImage,\n          signature: response.data.signature,\n          timestamp: new Date().toISOString(),\n          useOptimized\n        };\n        setSignatureDetails(signatureData);\n        localStorage.setItem('certificationDetails', JSON.stringify(signatureData));\n        console.log('已保存签名详情到本地存储');\n        setStatus('认证成功！您的根账户已成功认证。');\n        setLocalIsCertified(true);\n        console.log('认证成功，已更新UI状态');\n\n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(true, signatureData);\n          console.log('已通知父组件认证状态更新');\n        }\n      } else {\n        console.log('认证失败:', response.data.error || '未知错误');\n        setStatus('认证失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('认证过程发生错误:', error);\n      console.log('错误详情:', {\n        message: error.message,\n        response: error.response ? {\n          status: error.response.status,\n          data: error.response.data\n        } : '无响应数据'\n      });\n      setStatus('认证失败: ' + (((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error) || error.message));\n    } finally {\n      setProcessingStep('');\n      console.log('认证流程结束');\n    }\n  };\n\n  // 重新认证\n  const recertifySeedAccount = () => {\n    // 清除认证状态\n    setLocalIsCertified(false);\n    setSignatureDetails(null);\n\n    // 清除本地存储中的认证数据\n    localStorage.removeItem('certificationDetails');\n    localStorage.removeItem('shadowSignatureDetails');\n\n    // 重新检查认证状态\n    checkCertificationStatus();\n\n    // 通知父组件认证状态\n    if (onCertificationUpdated) {\n      onCertificationUpdated(false, null);\n    }\n    setStatus('认证状态已重置，请重新认证根账户。');\n  };\n\n  // 验证认证状态\n  const verifyCertification = async () => {\n    console.log('开始验证认证状态...');\n    try {\n      setVerifying(true);\n\n      // 从本地存储获取认证信息\n      const storedAuthToken = localStorage.getItem('authToken');\n      const storedSeedAddress = localStorage.getItem('seedAddress');\n      console.log('从本地存储获取认证信息:', {\n        hasAuthToken: !!storedAuthToken,\n        hasSeedAddress: !!storedSeedAddress,\n        authToken: storedAuthToken ? storedAuthToken.substring(0, 8) + '...' : null,\n        seedAddress: storedSeedAddress\n      });\n      if (!storedAuthToken || !storedSeedAddress) {\n        console.error('本地存储中没有认证信息');\n        setLocalIsCertified(false);\n        setVerifying(false);\n        setStatus('验证失败: 未找到认证信息');\n        return;\n      }\n\n      // 调用后端API验证认证状态\n      console.log('发送验证请求到后端...');\n      console.log('API URL:', config.getApiUrl('verifyCertification'));\n      const response = await axios.post(config.getApiUrl('verifyCertification'), {\n        seedAddress: storedSeedAddress,\n        authToken: storedAuthToken\n      });\n      console.log('收到验证响应:', response.data);\n      if (response.data.isCertified) {\n        console.log('验证成功，账户已认证');\n        setLocalIsCertified(true);\n        setLocalSoulAddress(response.data.soulAddress);\n        // 存储灵魂地址到本地存储\n        localStorage.setItem('soulAddress', response.data.soulAddress);\n        setStatus('验证成功: 您的根账户已认证');\n      } else {\n        console.log('验证失败，账户未认证');\n        setLocalIsCertified(false);\n        // 清除本地存储中的认证信息\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('soulAddress');\n        setStatus('验证失败: 您的根账户未认证');\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      console.error('验证过程发生错误:', error);\n      console.log('错误详情:', {\n        message: error.message,\n        response: error.response ? {\n          status: error.response.status,\n          data: error.response.data\n        } : '无响应数据'\n      });\n      setLocalIsCertified(false);\n      // 清除本地存储中的认证信息\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('soulAddress');\n      setStatus('验证失败: ' + (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || error.message));\n    } finally {\n      setVerifying(false);\n      console.log('验证流程结束');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"certification-manager\",\n    children: [!localIsCertified ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"certification-form\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"certification-info\",\n        children: \"\\u8BA4\\u8BC1\\u6839\\u8D26\\u6237\\u53EF\\u4EE5\\u5C06\\u60A8\\u7684\\u6839\\u8D26\\u6237\\u4E0E\\u5F71\\u5B50\\u8D26\\u6237\\u5173\\u8054\\u8D77\\u6765\\u3002 \\u901A\\u8FC7\\u73AF\\u7B7E\\u540D\\u6280\\u672F\\uFF0C\\u60A8\\u53EF\\u4EE5\\u5728\\u4E0D\\u6CC4\\u9732\\u6839\\u8D26\\u6237\\u8EAB\\u4EFD\\u7684\\u60C5\\u51B5\\u4E0B\\u8BC1\\u660E\\u60A8\\u62E5\\u6709\\u5F71\\u5B50\\u8D26\\u6237\\u7684\\u63A7\\u5236\\u6743\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"certification-options\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"option\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            id: \"optimized\",\n            name: \"signatureType\",\n            checked: useOptimized,\n            onChange: () => setUseOptimized(true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"optimized\",\n            children: \"\\u4F7F\\u7528\\u4F18\\u5316\\u7248\\u73AF\\u7B7E\\u540D\\uFF08\\u63A8\\u8350\\uFF0Cgas \\u8D39\\u66F4\\u4F4E\\uFF09\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"option\",\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"radio\",\n            id: \"standard\",\n            name: \"signatureType\",\n            checked: !useOptimized,\n            onChange: () => setUseOptimized(false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"standard\",\n            children: \"\\u4F7F\\u7528\\u6807\\u51C6\\u7248\\u73AF\\u7B7E\\u540D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: certifySeedAccount,\n        className: \"certify-button\",\n        disabled: !seedAddress || parseFloat(balance) <= 0,\n        children: \"\\u8BA4\\u8BC1\\u6839\\u8D26\\u6237\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 11\n      }, this), parseFloat(balance) <= 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"warning\",\n        children: \"\\u6839\\u8D26\\u6237\\u4F59\\u989D\\u4E0D\\u8DB3\\uFF0C\\u8BF7\\u5148\\u5411\\u6839\\u8D26\\u6237\\u5730\\u5740\\u53D1\\u9001\\u4E00\\u4E9B ETH \\u4F5C\\u4E3A gas \\u8D39\\u3002\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: verifyCertification,\n        className: \"verify-button\",\n        disabled: verifying,\n        children: \"\\u9A8C\\u8BC1\\u8BA4\\u8BC1\\u72B6\\u6001\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"certification-status\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"status-header\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"\\u8BA4\\u8BC1\\u72B6\\u6001\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 401,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"certified-badge\",\n            children: \"\\u5DF2\\u8BA4\\u8BC1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 402,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u60A8\\u7684\\u6839\\u8D26\\u6237\\u5DF2\\u6210\\u529F\\u8BA4\\u8BC1\\u5E76\\u5173\\u8054\\u5F71\\u5B50\\u8D26\\u6237\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 404,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u73B0\\u5728\\u60A8\\u53EF\\u4EE5\\u4F7F\\u7528\\u5F71\\u5B50\\u8D26\\u6237\\u8FDB\\u884C\\u4EA4\\u6613\\uFF0C\\u800C\\u4E0D\\u6CC4\\u9732\\u60A8\\u7684\\u8EAB\\u4EFD\\u3002\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 405,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: recertifySeedAccount,\n          className: \"recertify-button\",\n          children: \"\\u91CD\\u65B0\\u8BA4\\u8BC1\\u6839\\u8D26\\u6237\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: verifyCertification,\n          className: \"verify-button\",\n          disabled: verifying,\n          children: \"\\u9A8C\\u8BC1\\u8BA4\\u8BC1\\u72B6\\u6001\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 414,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 9\n    }, this), processingStep && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"processing-steps\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"\\u5904\\u7406\\u6B65\\u9AA4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"step-indicator\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: `step ${processingStep === '准备环签名' ? 'active' : ''}`,\n          children: \"\\u51C6\\u5907\\u73AF\\u7B7E\\u540D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `step ${processingStep === '提交交易' ? 'active' : ''}`,\n          children: \"\\u63D0\\u4EA4\\u4EA4\\u6613\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `step ${processingStep === '等待确认' ? 'active' : ''}`,\n          children: \"\\u7B49\\u5F85\\u786E\\u8BA4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 428,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 9\n    }, this), status && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"status-message\",\n      children: status\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 18\n    }, this), signatureDetails && localIsCertified && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"signature-section\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"signature-details\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: [\"\\u73AF\\u7B7E\\u540D\\u8BE6\\u60C5 \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowDetails(!showDetails),\n            children: showDetails ? '隐藏' : '显示'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 23\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 13\n        }, this), showDetails && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"details-content\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u751F\\u6210\\u65F6\\u95F4:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 445,\n              columnNumber: 20\n            }, this), \" \", signatureDetails.timestamp]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 445,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u5173\\u952E\\u6620\\u50CF (Key Image):\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 20\n            }, this), \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"code\",\n              children: [signatureDetails.keyImage.substring(0, 20), \"...\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 446,\n              columnNumber: 55\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"\\u73AF\\u5927\\u5C0F:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 447,\n              columnNumber: 20\n            }, this), \" \", signatureDetails.ring.length, \" \\u4E2A\\u6210\\u5458\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"collapsible\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\u73AF\\u6210\\u5458 (Ring Members)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 450,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"scrollable\",\n              children: signatureDetails.ring.map((member, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ring-member\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"index\",\n                  children: [index + 1, \".\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 454,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"address\",\n                  children: member\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 455,\n                  columnNumber: 25\n                }, this), member === seedAddress && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"tag\",\n                  children: \"\\u7B7E\\u540D\\u8005\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 456,\n                  columnNumber: 52\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 23\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"collapsible\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"\\u7B7E\\u540D\\u6570\\u636E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"signature-data\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"c \\u503C:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 465,\n                  columnNumber: 24\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scrollable\",\n                children: signatureDetails.signature.c.map((c, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"data-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"index\",\n                    children: [index + 1, \".\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 469,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"value\",\n                    children: [c.substring(0, 20), \"...\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 470,\n                    columnNumber: 27\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 468,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 466,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"r \\u503C:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 475,\n                  columnNumber: 24\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 475,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scrollable\",\n                children: signatureDetails.signature.r.map((r, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"data-row\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"index\",\n                    children: [index + 1, \".\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 479,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"value\",\n                    children: [r.substring(0, 20), \"...\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 480,\n                    columnNumber: 27\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 478,\n                  columnNumber: 25\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 464,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 444,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 440,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(RingSignatureVisualizer, {\n        signatureDetails: signatureDetails,\n        seedAddress: seedAddress\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 490,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 439,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 343,\n    columnNumber: 5\n  }, this);\n}\n_s(CertificationManager, \"UWVo9Z0wPDLTWU/NJSI+3kTdFrQ=\");\n_c = CertificationManager;\nexport default CertificationManager;\nvar _c;\n$RefreshReg$(_c, \"CertificationManager\");","map":{"version":3,"names":["React","useState","useEffect","ethers","axios","RingSignatureVisualizer","config","jsxDEV","_jsxDEV","contractABI","contractAddress","CertificationManager","seedAddress","soulAddress","isCertified","onCertificationUpdated","_s","status","setStatus","provider","setProvider","signatureDetails","setSignatureDetails","showDetails","setShowDetails","processingStep","setProcessingStep","useOptimized","setUseOptimized","balance","setBalance","localIsCertified","setLocalIsCertified","verifying","setVerifying","localSoulAddress","setLocalSoulAddress","initProvider","providers","JsonRpcProvider","loadStoredCertification","storedCertification","localStorage","getItem","certData","JSON","parse","error","console","checkBalance","checkCertificationStatus","balanceWei","getBalance","balanceEth","parseFloat","utils","formatEther","toFixed","message","contract","Contract","certified","linkedSoul","getSoulAccount","log","certifySeedAccount","seedPrivateKey","privateKey","sessionStorage","repeat","substring","setItem","nonce","Math","floor","random","toString","requestData","Array","fill","map","join","seedPrivateKeyLength","length","getApiUrl","seedPrivateKeyExists","response","post","valid","data","hasAuthToken","authToken","hasKeyImage","keyImage","ringLength","ring","stringify","signatureData","signature","timestamp","Date","toISOString","_error$response","_error$response$data","recertifySeedAccount","removeItem","verifyCertification","storedAuthToken","storedSeedAddress","hasSeedAddress","_error$response2","_error$response2$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","id","name","checked","onChange","htmlFor","onClick","disabled","member","index","c","r","_c","$RefreshReg$"],"sources":["/Users/sanji/AA/Seed Account/frontend/src/components/CertificationManager.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { ethers } from 'ethers';\nimport axios from 'axios';\nimport './CertificationManager.css';\nimport RingSignatureVisualizer from './RingSignatureVisualizer';\nimport config from '../config';\n\n// SeedCertifier 合约 ABI\nconst contractABI = [\n  \"function certifySeed(address seedAddr, address soulAddr, address[] calldata ring, bytes32 keyImage, bytes32[] calldata c, bytes32[] calldata r) external\",\n  \"function certifySeedOptimized(address seedAddr, address soulAddr, address[] calldata ring, bytes32 keyImage, bytes32[] calldata z, bytes32 finalHash, bytes32 c0) external\",\n  \"function isCertified(address seedAddr) external view returns (bool)\",\n  \"function getSoulAccount(address seedAddr) external view returns (address)\",\n  \"event SeedCertified(address indexed seedAddr, address indexed soulAddr, bytes32 keyImage)\"\n];\n\n// Sepolia 网络上部署的合约地址\nconst contractAddress = \"0x226C796394190AdAE21Bf619EE4296cD1C38b277\";\n\nfunction CertificationManager({ seedAddress, soulAddress, isCertified, onCertificationUpdated }) {\n  const [status, setStatus] = useState('');\n  const [provider, setProvider] = useState(null);\n  const [signatureDetails, setSignatureDetails] = useState(null);\n  const [showDetails, setShowDetails] = useState(false);\n  const [processingStep, setProcessingStep] = useState('');\n  const [useOptimized, setUseOptimized] = useState(true);\n  const [balance, setBalance] = useState('0');\n  const [localIsCertified, setLocalIsCertified] = useState(isCertified);\n  const [verifying, setVerifying] = useState(false);\n  const [localSoulAddress, setLocalSoulAddress] = useState(soulAddress || '');\n  \n  // 初始化\n  useEffect(() => {\n    const initProvider = async () => {\n      // 使用公共 RPC 提供商\n      const provider = new ethers.providers.JsonRpcProvider('https://sepolia.infura.io/v3/dbe77fbac5b8494e8f03b1099638abfd');\n      setProvider(provider);\n    };\n    \n    initProvider();\n    \n    // 从本地存储加载认证数据\n    const loadStoredCertification = () => {\n      try {\n        const storedCertification = localStorage.getItem('certificationDetails');\n        if (storedCertification) {\n          const certData = JSON.parse(storedCertification);\n          setSignatureDetails(certData);\n        }\n      } catch (error) {\n        console.error('加载存储的认证数据失败:', error);\n      }\n    };\n    \n    loadStoredCertification();\n  }, []);\n  \n  // 当 isCertified prop 变化时更新本地状态\n  useEffect(() => {\n    setLocalIsCertified(isCertified);\n  }, [isCertified]);\n  \n  // 当根账户或提供商变化时，检查余额和认证状态\n  useEffect(() => {\n    if (seedAddress && provider) {\n      checkBalance();\n      checkCertificationStatus();\n    }\n  }, [seedAddress, provider]);\n  \n  // 检查余额\n  const checkBalance = async () => {\n    if (!seedAddress || !provider) return;\n    \n    try {\n      const balanceWei = await provider.getBalance(seedAddress);\n      // 将 Wei 转换为 ETH，并保留 5 位小数\n      const balanceEth = parseFloat(ethers.utils.formatEther(balanceWei)).toFixed(5);\n      setBalance(balanceEth);\n    } catch (error) {\n      console.error('获取余额失败:', error);\n      setStatus('获取余额失败: ' + error.message);\n    }\n  };\n  \n  // 检查认证状态\n  const checkCertificationStatus = async () => {\n    if (!seedAddress || !provider) return;\n    \n    try {\n      const contract = new ethers.Contract(contractAddress, contractABI, provider);\n      const certified = await contract.isCertified(seedAddress);\n      \n      setLocalIsCertified(certified);\n      \n      if (certified) {\n        const linkedSoul = await contract.getSoulAccount(seedAddress);\n        console.log('根账户已认证，关联的影子账户:', linkedSoul);\n        \n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(true, signatureDetails);\n        }\n      } else {\n        console.log('根账户未认证');\n        \n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(false, null);\n        }\n      }\n    } catch (error) {\n      console.error('检查认证状态失败:', error);\n      setStatus('检查认证状态失败: ' + error.message);\n    }\n  };\n  \n  // 认证根账户（实际调用后端API）\n  const certifySeedAccount = async () => {\n    if (!seedAddress) {\n      setStatus('请先创建根账户');\n      console.log('认证失败: 未提供根账户地址');\n      return;\n    }\n    \n    console.log('开始认证流程，根账户地址:', seedAddress);\n    \n    try {\n      setStatus('正在准备认证...');\n      setProcessingStep('准备环签名');\n      \n      // 获取私钥（在实际应用中，这应该从安全存储中获取）\n      const seedPrivateKey = localStorage.getItem('seedPrivateKey');\n      console.log('从本地存储获取私钥:', seedPrivateKey ? '成功' : '失败');\n      \n      // 如果没有找到私钥，尝试从会话存储中获取\n      let privateKey = seedPrivateKey;\n      if (!privateKey) {\n        privateKey = sessionStorage.getItem('seedPrivateKey');\n        console.log('从会话存储获取私钥:', privateKey ? '成功' : '失败');\n      }\n      \n      // 如果仍然没有找到私钥，尝试使用硬编码的测试私钥（仅用于开发）\n      if (!privateKey) {\n        // 这只是一个示例私钥，实际应用中不应该硬编码\n        privateKey = '0x' + '1'.repeat(64); // 示例私钥，实际使用时应替换\n        console.log('使用测试私钥:', privateKey.substring(0, 10) + '...');\n        \n        // 将测试私钥保存到本地存储，以便后续使用\n        localStorage.setItem('seedPrivateKey', privateKey);\n        console.log('已将测试私钥保存到本地存储');\n      }\n      \n      // 生成随机nonce防止重放攻击\n      const nonce = Math.floor(Math.random() * 1000000).toString();\n      console.log('生成nonce:', nonce);\n      \n      // 准备请求数据\n      const requestData = {\n        seedAddress,\n        seedPrivateKey: privateKey,\n        soulAddress: localSoulAddress || '0x' + Array(40).fill(0).map(() => Math.floor(Math.random() * 16).toString(16)).join(''),\n        nonce\n      };\n      \n      console.log('准备发送请求数据:', {\n        seedAddress: requestData.seedAddress,\n        seedPrivateKeyLength: requestData.seedPrivateKey ? requestData.seedPrivateKey.length : 0,\n        soulAddress: requestData.soulAddress,\n        nonce: requestData.nonce\n      });\n      \n      // 在发送请求前检查API URL\n      console.log('API URL:', config.getApiUrl('generateSignature'));\n\n      // 检查本地存储中的所有项\n      console.log('本地存储内容:', {\n        seedAddress: localStorage.getItem('seedAddress'),\n        seedPrivateKeyExists: !!localStorage.getItem('seedPrivateKey'),\n        seedPrivateKeyLength: localStorage.getItem('seedPrivateKey') ? localStorage.getItem('seedPrivateKey').length : 0\n      });\n      \n      // 调用后端API生成环签名\n      console.log('发送认证请求到后端...');\n      const response = await axios.post(config.getApiUrl('generateSignature'), requestData);\n      \n      console.log('收到认证响应:', {\n        valid: response.data.valid,\n        hasAuthToken: !!response.data.authToken,\n        hasKeyImage: !!response.data.keyImage,\n        ringLength: response.data.ring ? response.data.ring.length : 0\n      });\n      \n      if (response.data.valid) {\n        // 保存认证信息到本地存储\n        localStorage.setItem('authToken', response.data.authToken);\n        localStorage.setItem('seedAddress', seedAddress);\n        localStorage.setItem('keyImage', response.data.keyImage);\n        localStorage.setItem('ring', JSON.stringify(response.data.ring));\n        \n        console.log('已保存认证信息到本地存储:', {\n          authToken: response.data.authToken ? response.data.authToken.substring(0, 8) + '...' : null,\n          seedAddress,\n          keyImage: response.data.keyImage ? response.data.keyImage.substring(0, 10) + '...' : null\n        });\n        \n        // 保存签名详情\n        const signatureData = {\n          ring: response.data.ring,\n          keyImage: response.data.keyImage,\n          signature: response.data.signature,\n          timestamp: new Date().toISOString(),\n          useOptimized\n        };\n        \n        setSignatureDetails(signatureData);\n        localStorage.setItem('certificationDetails', JSON.stringify(signatureData));\n        console.log('已保存签名详情到本地存储');\n        \n        setStatus('认证成功！您的根账户已成功认证。');\n        setLocalIsCertified(true);\n        console.log('认证成功，已更新UI状态');\n        \n        // 通知父组件认证状态\n        if (onCertificationUpdated) {\n          onCertificationUpdated(true, signatureData);\n          console.log('已通知父组件认证状态更新');\n        }\n      } else {\n        console.log('认证失败:', response.data.error || '未知错误');\n        setStatus('认证失败: ' + (response.data.error || '未知错误'));\n      }\n    } catch (error) {\n      console.error('认证过程发生错误:', error);\n      console.log('错误详情:', {\n        message: error.message,\n        response: error.response ? {\n          status: error.response.status,\n          data: error.response.data\n        } : '无响应数据'\n      });\n      setStatus('认证失败: ' + (error.response?.data?.error || error.message));\n    } finally {\n      setProcessingStep('');\n      console.log('认证流程结束');\n    }\n  };\n  \n  // 重新认证\n  const recertifySeedAccount = () => {\n    // 清除认证状态\n    setLocalIsCertified(false);\n    setSignatureDetails(null);\n    \n    // 清除本地存储中的认证数据\n    localStorage.removeItem('certificationDetails');\n    localStorage.removeItem('shadowSignatureDetails');\n    \n    // 重新检查认证状态\n    checkCertificationStatus();\n    \n    // 通知父组件认证状态\n    if (onCertificationUpdated) {\n      onCertificationUpdated(false, null);\n    }\n    \n    setStatus('认证状态已重置，请重新认证根账户。');\n  };\n  \n  // 验证认证状态\n  const verifyCertification = async () => {\n    console.log('开始验证认证状态...');\n    \n    try {\n      setVerifying(true);\n      \n      // 从本地存储获取认证信息\n      const storedAuthToken = localStorage.getItem('authToken');\n      const storedSeedAddress = localStorage.getItem('seedAddress');\n      \n      console.log('从本地存储获取认证信息:', {\n        hasAuthToken: !!storedAuthToken,\n        hasSeedAddress: !!storedSeedAddress,\n        authToken: storedAuthToken ? storedAuthToken.substring(0, 8) + '...' : null,\n        seedAddress: storedSeedAddress\n      });\n      \n      if (!storedAuthToken || !storedSeedAddress) {\n        console.error('本地存储中没有认证信息');\n        setLocalIsCertified(false);\n        setVerifying(false);\n        setStatus('验证失败: 未找到认证信息');\n        return;\n      }\n      \n      // 调用后端API验证认证状态\n      console.log('发送验证请求到后端...');\n      console.log('API URL:', config.getApiUrl('verifyCertification'));\n      \n      const response = await axios.post(config.getApiUrl('verifyCertification'), {\n        seedAddress: storedSeedAddress,\n        authToken: storedAuthToken\n      });\n      \n      console.log('收到验证响应:', response.data);\n      \n      if (response.data.isCertified) {\n        console.log('验证成功，账户已认证');\n        setLocalIsCertified(true);\n        setLocalSoulAddress(response.data.soulAddress);\n        // 存储灵魂地址到本地存储\n        localStorage.setItem('soulAddress', response.data.soulAddress);\n        setStatus('验证成功: 您的根账户已认证');\n      } else {\n        console.log('验证失败，账户未认证');\n        setLocalIsCertified(false);\n        // 清除本地存储中的认证信息\n        localStorage.removeItem('authToken');\n        localStorage.removeItem('soulAddress');\n        setStatus('验证失败: 您的根账户未认证');\n      }\n    } catch (error) {\n      console.error('验证过程发生错误:', error);\n      console.log('错误详情:', {\n        message: error.message,\n        response: error.response ? {\n          status: error.response.status,\n          data: error.response.data\n        } : '无响应数据'\n      });\n      setLocalIsCertified(false);\n      // 清除本地存储中的认证信息\n      localStorage.removeItem('authToken');\n      localStorage.removeItem('soulAddress');\n      setStatus('验证失败: ' + (error.response?.data?.error || error.message));\n    } finally {\n      setVerifying(false);\n      console.log('验证流程结束');\n    }\n  };\n  \n  return (\n    <div className=\"certification-manager\">\n      {!localIsCertified ? (\n        <div className=\"certification-form\">\n          <p className=\"certification-info\">\n            认证根账户可以将您的根账户与影子账户关联起来。\n            通过环签名技术，您可以在不泄露根账户身份的情况下证明您拥有影子账户的控制权。\n          </p>\n          \n          <div className=\"certification-options\">\n            <div className=\"option\">\n              <input \n                type=\"radio\" \n                id=\"optimized\" \n                name=\"signatureType\" \n                checked={useOptimized} \n                onChange={() => setUseOptimized(true)}\n              />\n              <label htmlFor=\"optimized\">使用优化版环签名（推荐，gas 费更低）</label>\n            </div>\n            \n            <div className=\"option\">\n              <input \n                type=\"radio\" \n                id=\"standard\" \n                name=\"signatureType\" \n                checked={!useOptimized} \n                onChange={() => setUseOptimized(false)}\n              />\n              <label htmlFor=\"standard\">使用标准版环签名</label>\n            </div>\n          </div>\n          \n          <button \n            onClick={certifySeedAccount}\n            className=\"certify-button\"\n            disabled={!seedAddress || parseFloat(balance) <= 0}\n          >\n            认证根账户\n          </button>\n          \n          {parseFloat(balance) <= 0 && (\n            <p className=\"warning\">\n              根账户余额不足，请先向根账户地址发送一些 ETH 作为 gas 费。\n            </p>\n          )}\n          \n          <button \n            onClick={verifyCertification}\n            className=\"verify-button\"\n            disabled={verifying}\n          >\n            验证认证状态\n          </button>\n        </div>\n      ) : (\n        <div className=\"certification-status\">\n          <div className=\"status-card\">\n            <div className=\"status-header\">\n              <h3>认证状态</h3>\n              <span className=\"certified-badge\">已认证</span>\n            </div>\n            <p>您的根账户已成功认证并关联影子账户。</p>\n            <p>现在您可以使用影子账户进行交易，而不泄露您的身份。</p>\n            \n            <button \n              onClick={recertifySeedAccount}\n              className=\"recertify-button\"\n            >\n              重新认证根账户\n            </button>\n            \n            <button \n              onClick={verifyCertification}\n              className=\"verify-button\"\n              disabled={verifying}\n            >\n              验证认证状态\n            </button>\n          </div>\n        </div>\n      )}\n      \n      {processingStep && (\n        <div className=\"processing-steps\">\n          <h4>处理步骤</h4>\n          <div className=\"step-indicator\">\n            <div className={`step ${processingStep === '准备环签名' ? 'active' : ''}`}>准备环签名</div>\n            <div className={`step ${processingStep === '提交交易' ? 'active' : ''}`}>提交交易</div>\n            <div className={`step ${processingStep === '等待确认' ? 'active' : ''}`}>等待确认</div>\n          </div>\n        </div>\n      )}\n      \n      {status && <p className=\"status-message\">{status}</p>}\n      \n      {signatureDetails && localIsCertified && (\n        <div className=\"signature-section\">\n          <div className=\"signature-details\">\n            <h3>环签名详情 <button onClick={() => setShowDetails(!showDetails)}>{showDetails ? '隐藏' : '显示'}</button></h3>\n            \n            {showDetails && (\n              <div className=\"details-content\">\n                <p><strong>生成时间:</strong> {signatureDetails.timestamp}</p>\n                <p><strong>关键映像 (Key Image):</strong> <span className=\"code\">{signatureDetails.keyImage.substring(0, 20)}...</span></p>\n                <p><strong>环大小:</strong> {signatureDetails.ring.length} 个成员</p>\n                \n                <div className=\"collapsible\">\n                  <h4>环成员 (Ring Members)</h4>\n                  <div className=\"scrollable\">\n                    {signatureDetails.ring.map((member, index) => (\n                      <div key={index} className=\"ring-member\">\n                        <span className=\"index\">{index + 1}.</span>\n                        <span className=\"address\">{member}</span>\n                        {member === seedAddress && <span className=\"tag\">签名者</span>}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                \n                <div className=\"collapsible\">\n                  <h4>签名数据</h4>\n                  <div className=\"signature-data\">\n                    <p><strong>c 值:</strong></p>\n                    <div className=\"scrollable\">\n                      {signatureDetails.signature.c.map((c, index) => (\n                        <div key={index} className=\"data-row\">\n                          <span className=\"index\">{index + 1}.</span>\n                          <span className=\"value\">{c.substring(0, 20)}...</span>\n                        </div>\n                      ))}\n                    </div>\n                    \n                    <p><strong>r 值:</strong></p>\n                    <div className=\"scrollable\">\n                      {signatureDetails.signature.r.map((r, index) => (\n                        <div key={index} className=\"data-row\">\n                          <span className=\"index\">{index + 1}.</span>\n                          <span className=\"value\">{r.substring(0, 20)}...</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n          \n          <RingSignatureVisualizer signatureDetails={signatureDetails} seedAddress={seedAddress} />\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default CertificationManager; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}